/*!
███████ ██████  ██ ████████  ██████  ██████
██      ██   ██ ██    ██    ██    ██ ██   ██
█████   ██   ██ ██    ██    ██    ██ ██████
██      ██   ██ ██    ██    ██    ██ ██   ██
███████ ██████  ██    ██     ██████  ██   ██
2018 ~ Mark Hillard | (mark@)markhillard.com
*/

var E=$.noConflict(!0);E(document).ready(function(){var e,t,n,s,o=document.editor=CodeMirror.fromTextArea(htmlcode,{mode:"text/html",profile:"html",keyMap:"sublime",lineNumbers:!0,lineWrapping:!1,theme:"dracula",tabSize:4,indentUnit:4,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchTags:{bothTags:!0},matchBrackets:!1,autoCloseTags:!0,autoCloseBrackets:!0,scrollbarStyle:"overlay",styleActiveLine:!0}),a=document.editor=CodeMirror.fromTextArea(csscode,{mode:"css",profile:"css",keyMap:"sublime",lineNumbers:!0,lineWrapping:!1,theme:"dracula",tabSize:4,indentUnit:4,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:!0,autoCloseBrackets:!0,scrollbarStyle:"overlay",styleActiveLine:!0}),i=document.editor=CodeMirror.fromTextArea(jscode,{mode:"javascript",keyMap:"sublime",lineNumbers:!0,lineWrapping:!1,theme:"dracula",tabSize:4,indentUnit:4,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:!0,autoCloseBrackets:!0,scrollbarStyle:"overlay",styleActiveLine:!0});function l(){var t=E("#preview").contents().find("body");e=o.getValue(),t.html(e),r()}function r(){var e=E("#preview").contents().find("head"),t=a.getValue();e.html('<link rel="stylesheet" href="./css/reset.css"><style>'+t+"</style>")}if(n=document.getElementById("preview"),(t=n.contentDocument?n.contentDocument:n.contentWindow?n.contentWindow.document:n.document).open(),t.write(e),t.close(),r(),null===localStorage.getItem("htmlcode")){localStorage.setItem("htmlcode",'<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"><\/script>\n<main>\n    <h1>Editor</h1>\n    <p>Real-time, responsive HTML/CSS/JS code editor</p>\n    <p>Fork me on <a href="https://github.com/markhillard/Editor">GitHub</a></p>\n</main>')}if(null===localStorage.getItem("csscode")){localStorage.setItem("csscode",'@import url("https://fonts.googleapis.com/css?family=Droid+Sans:400,700");\n\nhtml,body {\n    background-color: #282a36;\n    color: #fff;\n    font-family: "Droid Sans", sans-serif;\n    overflow: hidden;\n    text-align: center;\n}\n\nmain {\n    left: 50%;\n    position: absolute;\n    top: 50%;\n    transform: translate(-50%,-50%);\n}\n\nh1 {\n    font-size: 10rem;\n    font-weight: 400;\n    margin: 0;\n}\n\np {\n    font-size: 1rem;\n    letter-spacing: .03rem;\n    line-height: 1.45;\n    margin: 1rem 0;\n}\n\na {\n    color: #6d8a88;\n}\n\n@media only screen and (max-width: 600px) {\n    h1 {\n        font-size: 5rem;\n    }\n}')}if(null===localStorage.getItem("jscode")){localStorage.setItem("jscode","$(document).ready(function () {\n    $('h1').fadeOut(800).fadeIn(800);\n    $('p').first().delay(400).fadeOut(800).fadeIn(400);\n    $('p').last().delay(800).fadeOut(800).fadeIn(400);\n});")}o.setValue(localStorage.getItem("htmlcode")),a.setValue(localStorage.getItem("csscode")),i.setValue(localStorage.getItem("jscode")),o.on("change",function(){clearTimeout(s),s=setTimeout(l,300),localStorage.setItem("htmlcode",o.getValue())}),a.on("change",function(){r(),localStorage.setItem("csscode",a.getValue())}),i.on("change",function(){localStorage.setItem("jscode",i.getValue())}),l();var c=E(".cdnjs-search .query");function d(){c.typeahead("val",""),c.typeahead("close")}E.get("https://api.cdnjs.com/libraries?fields=version,description").done(function(t){var n=t.results,s=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name"),queryTokenizer:Bloodhound.tokenizers.whitespace,local:n});c.typeahead(null,{display:"name",name:"search",source:s,limit:1e3,templates:{empty:function(){return'<p class="no-match">unable to match query!</p>'},suggestion:function(e){return'<p class="lib"><span class="name">'+e.name+'</span> <span class="version">'+e.version+'</span><br><span class="description">'+e.description+"</span></p>"}}}).on("typeahead:select",function(t,n){!function(t){var n;-1!==t.indexOf("<")?n=t:t.endsWith(".js")?n='<script src="'+t+'"><\/script>':t.endsWith(".css")&&(n='<style>@import url("'+t+'");</style>');if(-1!==e.indexOf(n))alert("dependency already included!");else{var s=e.split("<\/script>").length-1;o.replaceRange(n+"\n",{line:s,ch:0}),alert("dependency added successfully!")}}(n.latest),d()}).on("typeahead:change",function(){d()})}).fail(function(){alert("error getting cdnjs libraries!")});var p=E(".code-pane"),m=E(".preview-width"),h=E(window).width();function f(e){e.css({position:"relative",visibility:"visible"})}function u(e){e.css({position:"absolute",visibility:"hidden"})}p.resizable({handles:"e",minWidth:0,maxWidth:h-16,create:function(){var e=p.width(),t=h-e-16;m.text(t+"px")},resize:function(e,t){var n=t.size.width,s=h-n-16;t.element.next().css("width",h-n+"px"),t.element.next().find("iframe").css("pointer-events","none"),m.show(),n<=0?m.text(h-16+"px"):m.text(s+"px")},stop:function(e,t){t.element.next().find("iframe").css("pointer-events","inherit"),m.hide(),o.refresh(),a.refresh(),i.refresh()}}),E(".code-swap span").not(".toggle-view").on("click",function(){var e=E(".code-pane-html"),t=E(".code-pane-css"),n=E(".code-pane-js"),s=E(".toggle-lineWrapping.html"),o=E(".toggle-lineWrapping.css"),a=E(".toggle-lineWrapping.js"),i=E(".toggle-emmet"),l=E(".preview-pane");E(this).addClass("active").siblings().removeClass("active"),E(this).is(':contains("HTML")')?(f(e),f(s),f(i),u(t),u(o),u(n),u(a),E(window).width()<=800?u(l):f(l)):E(this).is(':contains("CSS")')?(f(t),f(o),f(i),u(e),u(s),u(n),u(a),E(window).width()<=800?u(l):f(l)):E(this).is(':contains("JS")')?(f(n),f(a),u(e),u(s),u(t),u(o),u(i),E(window).width()<=800?u(l):f(l)):E(this).is(':contains("preview")')&&(f(l),u(e),u(s),u(t),u(o),u(n),u(a),u(i))});var g=E(".CodeMirror-overlayscroll-vertical"),v=E(".CodeMirror-overlayscroll-horizontal");function y(e){var t=e.defaultCharWidth();e.on("renderLine",function(e,n,s){var o=CodeMirror.countColumn(n.text,null,e.getOption("tabSize"))*t;s.style.textIndent="-"+o+"px",s.style.paddingLeft=4+o+"px"})}g.on("mousedown",function(){E(this).addClass("hold")}),v.on("mousedown",function(){E(this).addClass("hold")}),E(document).on("mouseup",function(){g.removeClass("hold"),v.removeClass("hold")}),y(o),y(a),y(i),E(".toggle-view").on("click",function(){E(this).toggleClass("enabled"),E(this).hasClass("enabled")?E(this).html('view <span class="fas fa-chevron-up"></span>'):E(this).html('view <span class="fas fa-chevron-down"></span>')}),E(".toggle-tools").on("click",function(){E(this).toggleClass("active"),E(this).hasClass("active")?E(this).html('tools <span class="fas fa-chevron-up"></span>'):E(this).html('tools <span class="fas fa-chevron-down"></span>')}),E(".toggle-lineWrapping.html").on("click",function(){E(this).toggleClass("active"),E(this).hasClass("active")?(o.setOption("lineWrapping",!0),E(this).html('wrap <span class="fas fa-toggle-on"></span>')):(o.setOption("lineWrapping",!1),E(this).html('wrap <span class="fas fa-toggle-off"></span>'))}),E(".toggle-lineWrapping.css").on("click",function(){E(this).toggleClass("active"),E(this).hasClass("active")?(a.setOption("lineWrapping",!0),E(this).html('wrap <span class="fas fa-toggle-on"></span>')):(a.setOption("lineWrapping",!1),E(this).html('wrap <span class="fas fa-toggle-off"></span>'))}),E(".toggle-lineWrapping.js").on("click",function(){E(this).toggleClass("active"),E(this).hasClass("active")?(i.setOption("lineWrapping",!0),E(this).html('wrap <span class="fas fa-toggle-on"></span>')):(i.setOption("lineWrapping",!1),E(this).html('wrap <span class="fas fa-toggle-off"></span>'))}),E(".toggle-emmet").on("click",function(){E(this).toggleClass("active"),E(this).hasClass("active")?(emmetCodeMirror(o),emmetCodeMirror(a),E(this).html('emmet <span class="fas fa-toggle-on"></span>')):(emmetCodeMirror.dispose(o),emmetCodeMirror.dispose(a),E(this).html('emmet <span class="fas fa-toggle-off"></span>'))}),E(".reset-editor").on("click",function(){o.setValue('<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"><\/script>\n<main>\n    <h1>Editor</h1>\n    <p>Real-time, responsive HTML/CSS/JS code editor</p>\n    <p>Fork me on <a href="https://github.com/markhillard/Editor">GitHub</a></p>\n</main>'),a.setValue('@import url("https://fonts.googleapis.com/css?family=Droid+Sans:400,700");\n\nhtml,body {\n    background-color: #282a36;\n    color: #fff;\n    font-family: "Droid Sans", sans-serif;\n    overflow: hidden;\n    text-align: center;\n}\n\nmain {\n    left: 50%;\n    position: absolute;\n    top: 50%;\n    transform: translate(-50%,-50%);\n}\n\nh1 {\n    font-size: 10rem;\n    font-weight: 400;\n    margin: 0;\n}\n\np {\n    font-size: 1rem;\n    letter-spacing: .03rem;\n    line-height: 1.45;\n    margin: 1rem 0;\n}\n\na {\n    color: #6d8a88;\n}\n\n@media only screen and (max-width: 600px) {\n    h1 {\n        font-size: 5rem;\n    }\n}'),i.setValue("$(document).ready(function () {\n    $('h1').fadeOut(800).fadeIn(800);\n    $('p').first().delay(400).fadeOut(800).fadeIn(400);\n    $('p').last().delay(800).fadeOut(800).fadeIn(400);\n});")}),E(".refresh-editor").on("click",function(){location.reload()}),E(".clear-editor").on("click",function(){o.setValue(""),a.setValue(""),i.setValue("")}),E(".run-script").on("click",function(){var t,n,s;n=document.getElementById("preview"),s=i.getValue(),(t=n.contentDocument?n.contentDocument:n.contentWindow?n.contentWindow.document:n.document).open(),t.write(e+"<script>"+s+"<\/script>"),t.close(),r(),l(),E(window).width()<=800&&E(".toggle-preview").click()}),E(".save").on("click",function(){var e='<!DOCTYPE html>\n<html lang="en">\n<head>\n<meta name="viewport" content="width=device-width, initial-scale=1">\n<link rel="stylesheet" href="https://rawgit.com/markhillard/Editor/gh-pages/css/reset.css">\n<style>\n'+a.getValue()+"\n</style>\n</head>\n<body>\n"+o.getValue()+"\n<script>\n"+i.getValue()+"\n<\/script>\n</body>\n</html>\n",t=new Blob([e],{type:"text/html; charset=utf-8"});saveAs(t,"editor.html")}),o.refresh(),a.refresh(),i.refresh()});
